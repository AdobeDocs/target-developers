(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[9798],{12672:function(t,e,n){"use strict";n.r(e),n.d(e,{_frontmatter:function(){return o},default:function(){return x}});var a,l=n(22122),r=n(19756),d=(n(15007),n(64983)),m=n(99536),i=["components"],o={},p=(a="InlineAlert",function(t){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,d.mdx)("div",t)}),u={_frontmatter:o},s=m.Z;function x(t){var e=t.components,n=(0,r.Z)(t,i);return(0,d.mdx)(s,(0,l.Z)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,d.mdx)("h1",{id:"adobetargetsendnotificationsoptions"},"adobe.target.sendNotifications(options)"),(0,d.mdx)("p",null,"This function sends a notification to Target edge when an experience is rendered without using ",(0,d.mdx)("inlineCode",{parentName:"p"},"adobe.target.applyOffer()")," or ",(0,d.mdx)("inlineCode",{parentName:"p"},"adobe.target.applyOffers()"),"."),(0,d.mdx)(p,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"This function has been introduced in at.js 2.1.0 and will be available for any versions above 2.1.0."),(0,d.mdx)("table",null,(0,d.mdx)("thead",{parentName:"table"},(0,d.mdx)("tr",{parentName:"thead"},(0,d.mdx)("th",{parentName:"tr",align:null},"Key"),(0,d.mdx)("th",{parentName:"tr",align:null},"Type"),(0,d.mdx)("th",{parentName:"tr",align:null},"Required?"),(0,d.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,d.mdx)("tbody",{parentName:"table"},(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"consumerId"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},"Default value is client's global mbox if not provided. This key is used to generate the supplemental data ID used for A4T integration.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request"),(0,d.mdx)("td",{parentName:"tr",align:null},"Object"),(0,d.mdx)("td",{parentName:"tr",align:null},"Yes"),(0,d.mdx)("td",{parentName:"tr",align:null},"See Requests table below.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"timeout"),(0,d.mdx)("td",{parentName:"tr",align:null},"Number"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},"Request timeout. If not specified the default at.js timeout is used.")))),(0,d.mdx)("h2",{id:"request"},"Request"),(0,d.mdx)("table",null,(0,d.mdx)("thead",{parentName:"table"},(0,d.mdx)("tr",{parentName:"thead"},(0,d.mdx)("th",{parentName:"tr",align:null},"Field Name"),(0,d.mdx)("th",{parentName:"tr",align:null},"Type"),(0,d.mdx)("th",{parentName:"tr",align:null},"Required?"),(0,d.mdx)("th",{parentName:"tr",align:null},"Limitation"),(0,d.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,d.mdx)("tbody",{parentName:"table"},(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications"),(0,d.mdx)("td",{parentName:"tr",align:null},"Array of Objects"),(0,d.mdx)("td",{parentName:"tr",align:null},"Yes"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"Notifications for the displayed content, clicked selectors, and/or visited views or mboxes.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > address"),(0,d.mdx)("td",{parentName:"tr",align:null},"Object"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null})),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > address > url"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"URL from which the notification was fired.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > address > referringUrl"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"The referral URL from which the notification was fired.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > parameters"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},"The following names are not allowed for parameters:",(0,d.mdx)("ul",null,(0,d.mdx)("li",null,"orderId"),(0,d.mdx)("li",null,"orderTotal"),(0,d.mdx)("li",null,"productPurchasedIds")),"Consider the following:",(0,d.mdx)("ul",null,(0,d.mdx)("li",null,"Max 50 parameters limit."),(0,d.mdx)("li",null,"Parameter name should not be blank."),(0,d.mdx)("li",null,"Parameter name max length 128."),(0,d.mdx)("li",null,'Parameter name should not start with "profile."'),(0,d.mdx)("li",null,"Parameter value length max 5000."))),(0,d.mdx)("td",{parentName:"tr",align:null})),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > profileParameters"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},"The following names are not allowed for parameters:",(0,d.mdx)("ul",null,(0,d.mdx)("li",null,"orderId"),(0,d.mdx)("li",null,"orderTotal"),(0,d.mdx)("li",null,"productPurchasedIds")),"Consider the following:",(0,d.mdx)("ul",null,(0,d.mdx)("li",null,"Max 50 parameters limit."),(0,d.mdx)("li",null,"Parameter name should not be blank."),(0,d.mdx)("li",null,"Parameter name max length 128."),(0,d.mdx)("li",null,'Parameter name should not start with "profile."'),(0,d.mdx)("li",null,"Parameter value length max 5000."))),(0,d.mdx)("td",{parentName:"tr",align:null})),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > order"),(0,d.mdx)("td",{parentName:"tr",align:null},"Object"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"Object that describes the order details.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > order > id"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"<=")," 250 characters."),(0,d.mdx)("td",{parentName:"tr",align:null},"Order ID.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > order > total"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},">=")," 0"),(0,d.mdx)("td",{parentName:"tr",align:null},"Order Total.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > order > purchasedProductIds"),(0,d.mdx)("td",{parentName:"tr",align:null},"Array of String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("ul",null,(0,d.mdx)("li",null,"No blank values allowed."),(0,d.mdx)("li",null,"Each product Id max length 50."),(0,d.mdx)("li",null,"Product IDs, separated by commas and concatenated, total length should not exceed 250."))),(0,d.mdx)("td",{parentName:"tr",align:null},"Order Product IDs.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > product"),(0,d.mdx)("td",{parentName:"tr",align:null},"Object"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null})),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > product > id"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"<=")," 128 characters; cannot be blank."),(0,d.mdx)("td",{parentName:"tr",align:null},"Product ID.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > product > categoryId"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"<=")," 128 characters; cannot be blank."),(0,d.mdx)("td",{parentName:"tr",align:null},"Category ID.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > id"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"Yes"),(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"<=")," 200 characters."),(0,d.mdx)("td",{parentName:"tr",align:null},"Notification ID will be returned in response and will indicate that the notification was processed successfully.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > impressionId"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"<= 128")," characters."),(0,d.mdx)("td",{parentName:"tr",align:null},"Impression ID is used to stitch (link) the current notification with a previous notification or execute request. In case both of them match, the second and other subsequent requests will not generate a new impression to the activity or experience.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > type"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"Yes"),(0,d.mdx)("td",{parentName:"tr",align:null},"“click” or “display” is supported."),(0,d.mdx)("td",{parentName:"tr",align:null},"Notification type.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > timestamp"),(0,d.mdx)("td",{parentName:"tr",align:null},"Number",(0,d.mdx)("inlineCode",{parentName:"td"},"<int64>")),(0,d.mdx)("td",{parentName:"tr",align:null},"Yes"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"Timestamp of the notification in milliseconds elapsed since UNIX epoch.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > tokens"),(0,d.mdx)("td",{parentName:"tr",align:null},"Array of String"),(0,d.mdx)("td",{parentName:"tr",align:null},"Yes"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"A list of tokens for displayed content or clicked selectors, based on the type of notification.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > mbox"),(0,d.mdx)("td",{parentName:"tr",align:null},"Object"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"Notifications for the mbox.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > mbox > name"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},"No blank values allowed.",(0,d.mdx)("br",null),"Allowed chars: See note following this table."),(0,d.mdx)("td",{parentName:"tr",align:null},"mbox name.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > mbox > state"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"mbox state token.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > view"),(0,d.mdx)("td",{parentName:"tr",align:null},"Object"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null})),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > view > id"),(0,d.mdx)("td",{parentName:"tr",align:null},"Integer ",(0,d.mdx)("inlineCode",{parentName:"td"},"<int64>")),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"View id. The id that was assigned to the view when the view was created via the view API.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > view > name"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"<= 128")," characters."),(0,d.mdx)("td",{parentName:"tr",align:null},"Name of view.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > view > key"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"<=")," 512 characters."),(0,d.mdx)("td",{parentName:"tr",align:null},"View key. The key that was set with the view via the API.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},"Request > notifications > view > state"),(0,d.mdx)("td",{parentName:"tr",align:null},"String"),(0,d.mdx)("td",{parentName:"tr",align:null},"No"),(0,d.mdx)("td",{parentName:"tr",align:null}),(0,d.mdx)("td",{parentName:"tr",align:null},"View state token.")))),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"Note"),": The following characters are ",(0,d.mdx)("em",{parentName:"p"},"not")," allowed for ",(0,d.mdx)("inlineCode",{parentName:"p"},"Request > notifications > mbox > name"),":"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre"},"- '-, ./=`:;&!@#$%^&*()+|?~[]{}'\n")),(0,d.mdx)("h2",{id:"sendnotifications-call-after-rendering-prefetched-mboxes"},"sendNotifications() call after rendering prefetched mboxes"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-javascript"},'function createTokens(options) {\n  return options.map(e => e.eventToken);\n}\n\nfunction createNotification(mbox, type, tokens) {\n  const id = 11111; // here we should use a random ID like UUID\n  const timestamp = Date.now();\n  const { name, state, parameters, profileParameters, order, product } = mbox;\n  const result = {\n    id,\n    type,\n    timestamp,\n    parameters,\n    profileParameters,\n    order,\n    product\n  };\n\n  result.mbox = { name, state };\n  result.tokens = tokens;\n\n  return result;\n}\n\nadobe.target.getOffers({\n  request: {\n    prefetch: {\n      mboxes: [\n        {\n          index: 0,\n          name: "a1-serverside-ab"\n        }\n      ]\n    }\n  }\n})\n.then(response => {\n  const mboxes = response.prefetch.mboxes;\n  const notifications = mboxes.map(mbox => {\n    const type = "display";\n    const tokens = createTokens(mbox.options);\n\n    return createNotification(mbox, type, tokens);\n  });\n  \n  adobe.target.sendNotifications({\n    request: { notifications }\n  });\n})\n')),(0,d.mdx)(p,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"If you are using Adobe Analytics, ",(0,d.mdx)("inlineCode",{parentName:"p"},"getOffers()")," with prefetch only and ",(0,d.mdx)("inlineCode",{parentName:"p"},"sendNotifications()"),", the Analytics request must be fired after ",(0,d.mdx)("inlineCode",{parentName:"p"},"sendNotifications()")," is executed. The purpose of this is to ensure that the SDID generated by ",(0,d.mdx)("inlineCode",{parentName:"p"},"sendNotifications()")," will match the SDID sent to Analytics and Target."))}x.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-implement-client-side-atjs-atjs-functions-adobe-target-sendnotifications-atjs-21-md-613ef03ec2cdb5497574.js.map