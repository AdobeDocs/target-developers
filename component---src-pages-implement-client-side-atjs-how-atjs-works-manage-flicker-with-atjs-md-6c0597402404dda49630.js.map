{"version":3,"sources":["webpack://dev-site-documentation-template/./src/pages/implement/client-side/atjs/how-atjs-works/manage-flicker-with-atjs.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-implement-client-side-atjs-how-atjs-works-manage-flicker-with-atjs-md-6c0597402404dda49630.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/target-developers/target-developers/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"how-atjs-manages-flicker\"\n    }}>{`How at.js manages flicker`}</h1>\n    <p>{`Information about how the Target at.js JavaScript library prevents flicker during page or app load.`}</p>\n    <p>{`Flicker happens when default content momentarily displays to visitors before it is replaced by the activity content. Flicker is undesirable because it can be confusing to visitors.`}</p>\n    <h2 {...{\n      \"id\": \"using-an-auto-created-global-mbox\"\n    }}>{`Using an auto-created global mbox`}</h2>\n    <p>{`If you enable the `}<a parentName=\"p\" {...{\n        \"href\": \"/target-developers/src/pages/implement/client-side/atjs/global-mbox/customize-global-mbox.md\"\n      }}>{`Auto Create Global Mbox`}</a>{` setting when configuring at.js, at.js manages flicker by changing the opacity setting as the page loads. When at.js loads, it will change the opacity setting of the `}<inlineCode parentName=\"p\">{`<body>`}</inlineCode>{` element to \"0\", making the page initially invisible to visitors. After a response from Target is received—or if an error with the Target request is detected—at.js resets opacity to \"1\". This ensures that the visitor only sees the page after your activities' content has been applied.`}</p>\n    <p>{`If you enable the setting when configuring at.js, at.js will set HTML BODY style opacity to 0. After a response from Target is received, at.js resets HTML BODY opacity to 1.`}</p>\n    <p>{`Opacity set to 0 keeps the page content hidden to prevent flicker, but the browser still renders the page and loads all the necessary assets like CSS, images, etc.`}</p>\n    <p>{`If `}<inlineCode parentName=\"p\">{`opacity: 0`}</inlineCode>{` does not work in your implementation, you can also manage flicker by customizing `}<inlineCode parentName=\"p\">{`bodyHiddenStyle`}</inlineCode>{` and set it to `}<inlineCode parentName=\"p\">{`body {visibility:hidden !important}`}</inlineCode>{`. You can use either `}<inlineCode parentName=\"p\">{`body {opacity:0 !important}`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`body {visibility:hidden !important}`}</inlineCode>{`, whichever works best for your specific circumstance.`}</p>\n    <p>{`The following illustration shows the Hide Body and Show Body calls in both at.js 1.`}<em parentName=\"p\">{`x`}</em>{` and at.js 2.x.`}</p>\n    <p><strong parentName=\"p\">{`at.js 2.x`}</strong></p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"974px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"56.25%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/target-developers/static/fdcc47f1c4bea9c42b234f7319303707/cb523/atjs-20-flow-page-load-request.webp 320w\", \"/target-developers/static/fdcc47f1c4bea9c42b234f7319303707/797b9/atjs-20-flow-page-load-request.webp 640w\", \"/target-developers/static/fdcc47f1c4bea9c42b234f7319303707/c8839/atjs-20-flow-page-load-request.webp 974w\"],\n            \"sizes\": \"(max-width: 974px) 100vw, 974px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/target-developers/static/fdcc47f1c4bea9c42b234f7319303707/72799/atjs-20-flow-page-load-request.png 320w\", \"/target-developers/static/fdcc47f1c4bea9c42b234f7319303707/6af66/atjs-20-flow-page-load-request.png 640w\", \"/target-developers/static/fdcc47f1c4bea9c42b234f7319303707/09e48/atjs-20-flow-page-load-request.png 974w\"],\n            \"sizes\": \"(max-width: 974px) 100vw, 974px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/target-developers/static/fdcc47f1c4bea9c42b234f7319303707/09e48/atjs-20-flow-page-load-request.png\",\n            \"alt\": \"Target flow: at.js page load request\",\n            \"title\": \"Target flow: at.js page load request\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p><strong parentName=\"p\">{`at.js 1.`}<em parentName=\"strong\">{`x`}</em></strong></p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"674px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"52.81250000000001%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/target-developers/static/084ad0e7cf9d01775c2e5ca9cca85495/cb523/target-flow2.webp 320w\", \"/target-developers/static/084ad0e7cf9d01775c2e5ca9cca85495/797b9/target-flow2.webp 640w\", \"/target-developers/static/084ad0e7cf9d01775c2e5ca9cca85495/4a65f/target-flow2.webp 674w\"],\n            \"sizes\": \"(max-width: 674px) 100vw, 674px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/target-developers/static/084ad0e7cf9d01775c2e5ca9cca85495/72799/target-flow2.png 320w\", \"/target-developers/static/084ad0e7cf9d01775c2e5ca9cca85495/6af66/target-flow2.png 640w\", \"/target-developers/static/084ad0e7cf9d01775c2e5ca9cca85495/fdaf8/target-flow2.png 674w\"],\n            \"sizes\": \"(max-width: 674px) 100vw, 674px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/target-developers/static/084ad0e7cf9d01775c2e5ca9cca85495/fdaf8/target-flow2.png\",\n            \"alt\": \"alt image\",\n            \"title\": \"alt image\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`For more information about the `}<inlineCode parentName=\"p\">{`bodyHiddenStyle`}</inlineCode>{` override, see `}<a parentName=\"p\" {...{\n        \"href\": \"/target-developers/src/pages/implement/client-side/atjs/atjs-functions/targetglobalsettings.md\"\n      }}>{`targetGlobalSettings()`}</a>{`.`}</p>\n    <h2 {...{\n      \"id\": \"managing-flicker-when-loading-atjs-asynchronously\"\n    }}>{`Managing flicker when loading at.js asynchronously`}</h2>\n    <p>{`Loading at.js asynchronously is a great way to avoid blocking the browser from rendering; however, this technique can lead to flicker on the web page.`}</p>\n    <p>{`You can avoid flicker by using a pre-hiding snippet that will be visible after the relevant HTML elements are personalized by Target.`}</p>\n    <p>{`at.js can be loaded asynchronously, either directly embedded on the page or via a tag manager (for example Adobe Experience Platform Launch).`}</p>\n    <p>{`If at.js is embedded on the page, the snippet must be added before loading at.js. If you load at.js via a tag manager, which is also loaded asynchronously, you must add the snippet before loading the tag manager. If the tag manager is loaded syncronously, the script might be included within the tag manager before at.js.`}</p>\n    <p>{`The pre-hiding code snippet is as follows:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`;(function(win, doc, style, timeout) {\n  var STYLE_ID = 'at-body-style';\n\n  function getParent() {\n    return doc.getElementsByTagName('head')[0];\n  }\n\n  function addStyle(parent, id, def) {\n    if (!parent) {\n      return;\n    }\n\n    var style = doc.createElement('style');\n    style.id = id;\n    style.innerHTML = def;\n    parent.appendChild(style);\n  }\n\n  function removeStyle(parent, id) {\n    if (!parent) {\n      return;\n    }\n\n    var style = doc.getElementById(id);\n\n    if (!style) {\n      return;\n    }\n\n    parent.removeChild(style);\n  }\n\n  addStyle(getParent(), STYLE_ID, style);\n  setTimeout(function() {\n    removeStyle(getParent(), STYLE_ID);\n  }, timeout);\n}(window, document, \"body {opacity: 0 !important}\", 3000));\n`}</code></pre>\n    <p>{`By default the snippet pre-hides the whole HTML BODY. In some cases, you may only want to pre-hide certain HTML elements and not the entire page. You can achieve that by customizing the style parameter. It can be replaced with something that pre-hides only particular regions of the page.`}</p>\n    <p>{`For example, you have two regions identified by IDs container-1 and container-2, then the style can be replaced with the following:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`#container-1, #container-2 {opacity: 0 !important}\n`}</code></pre>\n    <p>{`Instead of the default:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`body {opacity: 0 !important}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"manage-flicker-in-atjs-2x-for-triggerview\"\n    }}>{`Manage flicker in at.js 2.x for triggerView()`}</h2>\n    <p>{`When using `}<inlineCode parentName=\"p\">{`triggerView()`}</inlineCode>{` to show targeted content in your SPA, flicker management is provided out of the box. This means that pre-hiding logic does not need to be added manually. Instead, at.js 2.x pre-hides the location where your view needs to be shown before applying the targeted content.`}</p>\n    <h2 {...{\n      \"id\": \"manage-flicker-with-getoffer-and-applyoffer\"\n    }}>{`Manage flicker with getOffer() and applyOffer()`}</h2>\n    <p>{`Because both `}<inlineCode parentName=\"p\">{`getOffer()`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`applyOffer()`}</inlineCode>{` are low-level APIs, there is no built-in flicker control. You can pass a selector or HTML element as an option to `}<inlineCode parentName=\"p\">{`applyOffer()`}</inlineCode>{`, in this case `}<inlineCode parentName=\"p\">{`applyOffer()`}</inlineCode>{` adds the activity content to this particular element; however, you must make sure the element is properly pre-hidden before invoking `}<inlineCode parentName=\"p\">{`getOffer()`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`applyOffer()`}</inlineCode>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`document.documentElement.style.opacity = \"0\";\n \nadobe.target.getOffer({\n    mbox: 'target-global-mbox',\n    success: function(offer) {\n        adobe.target.applyOffer({\n            mbox: 'target-global-mbox',\n            offer: offer\n        });\n \n        document.documentElement.style.opacity = \"1\";\n    },\n    error: function() {\n        document.documentElement.style.opacity = \"1\";        \n    }\n});\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"using-a-regional-mbox-with-mboxcreate-in-atjs-1x-not-supported-in-atjs-2x\"\n    }}>{`Using a regional mbox with mboxCreate() in at.js 1.x (not supported in at.js 2.x)`}</h2>\n    <p>{`If you use a regional mbox implementation, you can use `}<inlineCode parentName=\"p\">{`mboxCreate()`}</inlineCode>{` with your page provisioned similar to the following sample code:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`<div class=\"mboxDefault\">\nSome default content\n</div>\n<script>\nmboxCreate('some-mbox');\n</script>\n`}</code></pre>\n    <p>{`If your pages are properly provisioned, at.js manages flicker by appropriately switching the CSS \"visibility\" property of the element with the mboxDefault class.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}