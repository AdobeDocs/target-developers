"use strict";(self.webpackChunktarget_developers=self.webpackChunktarget_developers||[]).push([[8],{96008:function(e,n,t){t.r(n),t.d(n,{default:function(){return M}});var o,r,c,i,s,a=t(15007),l=t(1597),d=t(86029);!function(e){e.Call="call",e.Reply="reply",e.Syn="syn",e.SynAck="synAck",e.Ack="ack"}(o||(o={})),function(e){e.Fulfilled="fulfilled",e.Rejected="rejected"}(r||(r={})),function(e){e.ConnectionDestroyed="ConnectionDestroyed",e.ConnectionTimeout="ConnectionTimeout",e.NoIframeSrc="NoIframeSrc"}(c||(c={})),function(e){e.DataCloneError="DataCloneError"}(i||(i={})),function(e){e.Message="message"}(s||(s={}));const u={"http:":"80","https:":"443"},g=/^(https?:)?\/\/([^/:]+)?(:(\d+))?/,m=["file:","data:"];const f=e=>{let{name:n,message:t,stack:o}=e;return{name:n,message:t,stack:o}},h=e=>{const n=new Error;return Object.keys(e).forEach((t=>n[t]=e[t])),n};let p=0;var v=()=>++p;const w=e=>e?e.split("."):[],y=(e,n,t)=>{const o=w(n);return o.reduce(((e,n,r)=>(void 0===e[n]&&(e[n]={}),r===o.length-1&&(e[n]=t),e[n])),e),e},S=(e,n)=>{const t={};return Object.keys(e).forEach((o=>{const r=e[o],c=((e,n)=>{const t=w(n||"");return t.push(e),(e=>e.join("."))(t)})(o,n);"object"==typeof r&&Object.assign(t,S(r,c)),"function"==typeof r&&(t[c]=r)})),t};var E=(e,n,t,i,a)=>{const{localName:l,local:d,remote:u,originForSending:g,originForReceiving:m}=n;let f=!1;a("".concat(l,": Connecting call sender"));const p=t.reduce(((e,n)=>{var t;return e[n]=(t=n,function(){for(var e=arguments.length,n=new Array(e),p=0;p<e;p++)n[p]=arguments[p];let w;a("".concat(l,": Sending ").concat(t,"() call"));try{u.closed&&(w=!0)}catch(y){w=!0}if(w&&i(),f){const e=new Error("Unable to send ".concat(t,"() call due ")+"to destroyed connection");throw e.code=c.ConnectionDestroyed,e}return new Promise(((e,c)=>{const i=v(),f=n=>{if(n.source!==u||n.data.penpal!==o.Reply||n.data.id!==i)return;if("*"!==m&&n.origin!==m)return void a("".concat(l," received message from origin ").concat(n.origin," which did not match expected origin ").concat(m));const g=n.data;a("".concat(l,": Received ").concat(t,"() reply")),d.removeEventListener(s.Message,f);let p=g.returnValue;g.returnValueIsError&&(p=h(p)),(g.resolution===r.Fulfilled?e:c)(p)};d.addEventListener(s.Message,f);const p={penpal:o.Call,id:i,methodName:t,args:n};u.postMessage(p,g)}))}),e}),{});return Object.assign(e,(e=>{const n={};for(const t in e)y(n,t,e[t]);return n})(p)),()=>{f=!0}},k=(e,n,t,c,a)=>{const{destroy:l,onDestroy:d}=c;let u,g;const m={};return c=>{if("*"!==n&&c.origin!==n)return void a("Parent: Handshake - Received ACK message from origin ".concat(c.origin," which did not match expected origin ").concat(n));a("Parent: Handshake - Received ACK");const h={localName:"Parent",local:window,remote:c.source,originForSending:t,originForReceiving:n};u&&u(),u=((e,n,t)=>{const{localName:c,local:a,remote:l,originForSending:d,originForReceiving:u}=e;let g=!1;const m=e=>{if(e.source!==l||e.data.penpal!==o.Call)return;if("*"!==u&&e.origin!==u)return void t("".concat(c," received message from origin ").concat(e.origin," which did not match expected origin ").concat(u));const s=e.data,{methodName:a,args:m,id:h}=s;t("".concat(c,": Received ").concat(a,"() call"));const p=e=>n=>{if(t("".concat(c,": Sending ").concat(a,"() reply")),g)return void t("".concat(c,": Unable to send ").concat(a,"() reply due to destroyed connection"));const s={penpal:o.Reply,id:h,resolution:e,returnValue:n};e===r.Rejected&&n instanceof Error&&(s.returnValue=f(n),s.returnValueIsError=!0);try{l.postMessage(s,d)}catch(u){if(u.name===i.DataCloneError){const e={penpal:o.Reply,id:h,resolution:r.Rejected,returnValue:f(u),returnValueIsError:!0};l.postMessage(e,d)}throw u}};new Promise((e=>e(n[a].apply(n,m)))).then(p(r.Fulfilled),p(r.Rejected))};return a.addEventListener(s.Message,m),()=>{g=!0,a.removeEventListener(s.Message,m)}})(h,e,a),d(u),g&&g.forEach((e=>{delete m[e]})),g=c.data.methodNames;const p=E(m,h,g,l,a);return d(p),m}};var I=e=>{let{iframe:n,methods:t={},childOrigin:r,timeout:i,debug:a=!1}=e;const l=(e=>function(){if(e){for(var n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];console.log("[Penpal]",...t)}})(a),d=((e,n)=>{const t=[];let o=!1;return{destroy(r){o||(o=!0,n("".concat(e,": Destroying connection")),t.forEach((e=>{e(r)})))},onDestroy(e){o?e():t.push(e)}}})("Parent",l),{onDestroy:f,destroy:h}=d;r||((e=>{if(!e.src&&!e.srcdoc){const e=new Error("Iframe must have src or srcdoc property defined.");throw e.code=c.NoIframeSrc,e}})(n),r=(e=>{if(e&&m.find((n=>e.startsWith(n))))return"null";const n=document.location,t=g.exec(e);let o,r,c;t?(o=t[1]?t[1]:n.protocol,r=t[2],c=t[4]):(o=n.protocol,r=n.hostname,c=n.port);const i=c&&c!==u[o]?":".concat(c):"";return"".concat(o,"//").concat(r).concat(i)})(n.src));const p="null"===r?"*":r,v=S(t),w=((e,n,t,r)=>c=>{if(!c.source)return;if("*"!==t&&c.origin!==t)return void e("Parent: Handshake - Received SYN message from origin ".concat(c.origin," which did not match expected origin ").concat(t));e("Parent: Handshake - Received SYN, responding with SYN-ACK");const i={penpal:o.SynAck,methodNames:Object.keys(n)};c.source.postMessage(i,r)})(l,v,r,p),y=k(v,r,p,d,l),E=new Promise(((e,t)=>{const r=((e,n)=>{let t;return void 0!==e&&(t=window.setTimeout((()=>{const t=new Error("Connection timed out after ".concat(e,"ms"));t.code=c.ConnectionTimeout,n(t)}),e)),()=>{clearTimeout(t)}})(i,h),a=t=>{if(t.source===n.contentWindow&&t.data)if(t.data.penpal!==o.Syn)if(t.data.penpal!==o.Ack);else{const n=y(t);n&&(r(),e(n))}else w(t)};window.addEventListener(s.Message,a),l("Parent: Awaiting handshake"),((e,n)=>{const{destroy:t,onDestroy:o}=n,r=setInterval((()=>{e.isConnected||(clearInterval(r),t())}),6e4);o((()=>{clearInterval(r)}))})(n,d),f((e=>{window.removeEventListener(s.Message,a),e&&t(e)}))}));return{promise:E,destroy(){h()}}};var C=t(42075),R=t(26777),b=t(44264);var M=e=>{let{src:n,height:t="calc(100vh - var(--spectrum-global-dimension-size-800))",location:o}=e;const r=(0,a.useRef)(null),{ims:c,isLoadingIms:i}=(0,a.useContext)(R.ZP);let s;const{0:u,1:g}=(0,a.useState)(null),{0:m,1:f}=(0,a.useState)(!1);(0,a.useEffect)((()=>{u&&(0===r.current.clientHeight?u.onHide():u.onShow())}),[o.pathname]),(0,a.useEffect)((()=>{if(f(!1),null!=r&&!i){s=window.adobeIMS;const e=p();return()=>{e.destroy()}}}),[r,i]);const h=(0,b.Bm)(n)?n:(0,l.dq)(n),p=()=>{const e=I({iframe:r.current,childOrigin:(0,b.Bm)(n)?new URL(n).origin:window.origin,methods:{scrollTop(e){var n;void 0===e&&(e=0),null!==(n=document)&&void 0!==n&&n.scrollingElement&&(document.scrollingElement.scrollTop=e)},getURL(){var e,n;return null===(e=window)||void 0===e||null===(n=e.location)||void 0===n?void 0:n.href},setURL(e){var n;null!==(n=window)&&void 0!==n&&n.location&&(window.location=e)},setHeight(e){r.current.style.height=e},getIMSAccessToken(){var e;return null!==(e=s)&&void 0!==e&&e.isSignedInUser()?s.getAccessToken():null},getIMSProfile(){var e;return null!==(e=s)&&void 0!==e&&e.isSignedInUser()?s.getProfile():null},signIn(){s&&!s.isSignedInUser()&&s.signIn()},signOut(){s&&s.isSignedInUser()&&s.signOut()},getIMSClientId(){return s?s.adobeIdData.client_id:null}}});return e.promise.then((e=>{0===r.current.clientHeight?e.onHide():e.onShow(),g(e)})),f(!0),e};return(0,d.tZ)(a.default.Fragment,null,(0,d.tZ)("iframe",{title:"Main content",ref:r,src:m?h:"",css:(0,d.iv)("display:block;height:",t,";width:100%;border:none;","")}),(0,d.tZ)(C.$,null))}}}]);
//# sourceMappingURL=8-31a998a72d49c7679c0c.js.map